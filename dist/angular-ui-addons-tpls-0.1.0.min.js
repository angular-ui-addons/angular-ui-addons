/*
 * angular-ui-addons
 * http://angular-ui-addons.github.io

 * Version: 0.1.0 - 2014-11-21
 * License: MIT
 */
angular.module("angular-ui-addons",["angular-ui-addons.templates","angular-ui-addons.inclist","angular-ui-addons.validation"]),angular.module("angular-ui-addons.templates",["template/inclist/inclist-input.html","template/inclist/inclist-out-list.html"]),angular.module("angular-ui-addons.inclist",["ui.bootstrap"]).directive("inclist",function(){return{restrict:"AE",scope:{items:"=inclistItems",typeaheadItems:"="},controller:function(a){this.addItem=function(d,e){if(!(!angular.isDefined(d)||""===d||a.isUnique&&b(d,a.items,a.itemsField)||a.isTypeaheadRestrict&&!b(d,a.typeaheadItems,a.typeaheadItemsSearchFields)&&!a.isTypeaheadRestrictValidExcl||a.isTypeaheadRestrictValidExcl&&!b(d,a.typeaheadItems,a.typeaheadItemsSearchFields)&&!e)){var f=c(d,a.typeaheadItems,a.itemsField);return void 0===f&&(f={},f.id="id"+Date.now(),f[a.itemsField]=d),a.items.push(f),!0}return!1},this.getItems=function(){return a.items},this.getFlatItem=function(b){if(angular.isObject(b)&&angular.isUndefined(b[a.itemsField])){var c="Inclist list item should be an object with '"+a.itemsField+"' field to extract string value from";throw console.error(c),new Error(c)}return b[a.itemsField]},this.removeItem=function(b){var c=[];angular.forEach(a.items,function(d){d[a.itemsField]!=b&&c.push(d)}),a.items=c},this.getTypeaheadFlatItems=function(){var b=[];return angular.forEach(a.typeaheadItems,function(c){if(angular.isObject(c)&&angular.isUndefined(c[a.itemsField]))throw new Error("Typeahead list should contain objects with '"+a.itemsField+"' field to extract string value from");b.push(c[a.itemsField])}),b},this.getTypeaheadItems=function(){return a.typeaheadItems};var b=function(a,b,c){var d=!1;return angular.forEach(b,function(e){d||(console.log("searching item ",e," in ",b," by ",c," for ",a),c instanceof Array?angular.forEach(c,function(b){e[b]==a&&(d=!0),console.log("s:::: ",b,e[b],a,d)}):(e[c]==a&&(d=!0),console.log("s!!!!! ",c,e[c],a,d)))}),d},c=function(a,b,c){var d;return angular.forEach(b,function(b){b[c]==a&&(d=b)}),d}},link:function(a,b,c){a.isUnique=angular.isDefined(c.inclistUnique),a.isTypeaheadRestrict=angular.isDefined(c.typeaheadRestrict),a.isTypeaheadRestrictValidExcl=angular.isDefined(c.typeaheadRestrictValidExcl),a.typeaheadItemsSearchFields=angular.isDefined(c.typeaheadItemsSearchFields)?c.typeaheadItemsSearchFields.replace(/\s+/,"").split(","):"name",a.itemsField=c.inclistField,console.log("scope.typeaheadItemsSearchFields",a.typeaheadItemsSearchFields)}}}).directive("inclistInput",function(){return{require:"^inclist",restrict:"AE",scope:{inclistForm:"="},replace:!0,templateUrl:"template/inclist/inclist-input.html",compile:function(a,b){a.find("input").attr("ng-model","selection");var c=b.typeaheadLabelField||"name";return a.find("input").attr("typeahead","label as item."+c+" for item in getTypeaheadItems() | filter:$viewValue"),console.log("tAttrs.typeaheadTemplate",b.typeaheadTemplate),b.typeaheadTemplate&&a.find("input").attr("typeahead-template-url",b.typeaheadTemplate),b.inputType&&a.find("input").attr("type",b.inputType),function(a,b,c,d){b.find("input").attr("placeholder",c.placeholder),a.addItemFromSelection=function(){d.addItem(a.selection,!a.inclistForm.inclistFormItemInput.$error.email)&&(a.selection="",a.$apply())},a.getTypeaheadItems=function(){var a=d.getTypeaheadItems();return angular.isDefined(a)?a:[]},b.on("submit",a.addItemFromSelection)}}}}).directive("inclistOut",function(){return{require:"^inclist",restrict:"AE",scope:{},templateUrl:"template/inclist/inclist-out-list.html",link:function(a,b,c,d){a.items=d.getItems(),a.getFlatItem=function(a){return d.getFlatItem(a)},a.removeItem=function(b){d.removeItem(a.getFlatItem(b)),a.items=d.getItems()}}}}),angular.module("angular-ui-addons.validation",[]).directive("strongPassword",function(){var a=function(a){return a&&a.length>6};return{require:"ngModel",link:function(b,c,d,e){e.$parsers.unshift(function(b){var c=a(b);return e.$setValidity("strongPass",c),b}),e.$formatters.unshift(function(b){var c=a(b);return e.$setValidity("strongPass",c),b})}}}),angular.module("template/inclist/inclist-input.html",[]).run(["$templateCache",function(a){a.put("template/inclist/inclist-input.html",'<form name="inclistForm">\n  <!--\n    If using custom template you have to use <form> and <input> elements for the same as in current template\n    as of the directive \'inclist-input\' will inject appropriate behavior based on these elements.\n  -->\n  <div class="input-group">\n    <input autocomplete="off" class="form-control" name="inclistFormItemInput"\n           placeholder="Type here and press enter to add property">\n\n    <span class="input-group-btn"><button class="btn btn-default" type="submit">+</button></span>\n  </div>\n</form>\n')}]),angular.module("template/inclist/inclist-out-list.html",[]).run(["$templateCache",function(a){a.put("template/inclist/inclist-out-list.html",'<ul class="list-inline plates">\n  <li ng-repeat="item in items">{{ getFlatItem(item) }}\n    <button type="button" class="close" aria-hidden="true" ng-click="removeItem(item)">&times;</button>\n  </li>\n</ul>')}]);